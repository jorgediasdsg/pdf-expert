# ADR-010 — Adopt Gin as the main HTTP router

## Status
Accepted

## Context
In earlier phases, the project used the standard library `net/http` with `http.ServeMux` and custom handlers.  
This approach is minimal and idiomatic, but as the service grows, we need:

- easier route definition,
- better middleware composition,
- built-in helpers for JSON responses and request handling,
- a more expressive API for future features (auth, groups, etc.).

The Gin framework is widely used in real-world Go services and provides:

- a lightweight HTTP router,
- middleware support,
- simple JSON helpers,
- good ecosystem and community adoption.

Given that this project is meant to demonstrate the evolution of a real-world service, adopting Gin aligns with common industry practice.

## Decision
Switch from `net/http` routing to Gin as the main HTTP router.

- Introduce `internal/api/router.go` with:

    - `NewRouter(analyzer *pdfanalyzer.PDFAnalyzer) *gin.Engine`

- Use Gin to:

    - define routes (`router.POST("/analyze", handler.AnalyzePDF)`),
    - register middleware (`router.Use(GinMiddleware())`),
    - handle JSON responses (`c.JSON(...)`).

The handlers move from `func(w http.ResponseWriter, r *http.Request)` to `func(c *gin.Context)`.

## Consequences

### Positive
- Cleaner route definitions and grouping.
- Built-in support for middleware.
- Simpler JSON handling via `gin.H` and `c.JSON`.
- Easier to extend the API with more endpoints and features.
- Aligns the project with patterns commonly found in production APIs.

### Negative
- Introduces an external dependency (Gin).
- Slight learning curve for developers unfamiliar with Gin.
- Ties HTTP layer to Gin’s abstractions (still acceptable at the adapter level).
- Monitoring Gin updates for security and performance.

## Alternatives

1. Keep using `net/http` and `http.ServeMux`  
   Rejected: while minimal, it would require more boilerplate to achieve what Gin gives us out-of-the-box (middleware, routing ergonomics, etc.).

2. Use another router (chi, echo, etc.)  
   Rejected for now: Gin is widely adopted, documented, and sufficient for current needs. Switching router frameworks is a localized change at the HTTP adapter layer and can be revisited later if needed.